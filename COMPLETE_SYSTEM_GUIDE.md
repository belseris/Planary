# üìö ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö Planary - ‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå

## üéØ ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô

**Planary** ‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:
- ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏á‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏¢ (subtasks)
- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå (routine templates)
- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° mood ‡πÅ‡∏•‡∏∞ tags
- ‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (Trends Dashboard)

---

## üèóÔ∏è ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏∞‡∏ö‡∏ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    MOBILE APP (React Native)                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Login   ‚îÇ  ‚îÇActivities‚îÇ  ‚îÇ  Diary   ‚îÇ  ‚îÇ Profile  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ         ‚îÇ             ‚îÇ             ‚îÇ             ‚îÇ          ‚îÇ
‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ
‚îÇ                         ‚îÇ                                    ‚îÇ
‚îÇ                    API Client                                ‚îÇ
‚îÇ                         ‚îÇ                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ HTTP/JSON
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   BACKEND API (FastAPI)                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Login   ‚îÇ  ‚îÇActivities‚îÇ  ‚îÇ  Diary   ‚îÇ  ‚îÇ Profile  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  Router  ‚îÇ  ‚îÇ  Router  ‚îÇ  ‚îÇ  Router  ‚îÇ  ‚îÇ  Router  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ         ‚îÇ             ‚îÇ             ‚îÇ             ‚îÇ          ‚îÇ
‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ
‚îÇ                         ‚îÇ                                    ‚îÇ
‚îÇ                    SQLAlchemy ORM                            ‚îÇ
‚îÇ                         ‚îÇ                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          ‚ñº
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ   PostgreSQL DB   ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

# üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á BACKEND (FastAPI + PostgreSQL)

## üìÇ `/backend` - ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å

### üîß **main.py** - ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á Backend
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á FastAPI application
- ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô CORS (‡πÉ‡∏´‡πâ frontend ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÑ‡∏î‡πâ)
- ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ routers ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)

**‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**
```python
app = FastAPI(title="Planary API")
app.add_middleware(CORSMiddleware, allow_origins=["*"])  # ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ó‡∏∏‡∏Å origin
app.include_router(login.router)
app.include_router(register.router)
app.include_router(activities.router)
app.include_router(diary.router)
app.include_router(profile.router)
app.include_router(routine_activities.router)
app.include_router(trends.router)
```

---

## üìÇ `/backend/core` - ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏Å

### **config.py** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Environment Variables
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
- ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå `.env`
- ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà ‡πÄ‡∏ä‡πà‡∏ô DATABASE_URL, SECRET_KEY
- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î path ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå media

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**
```python
DATABASE_URL=postgresql+psycopg2://postgres:password@localhost:5432/Diary_db
SECRET_KEY=your-secret-key-for-jwt
ACCESS_TOKEN_EXPIRE_MINUTES=120
```

### **security.py** - ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. **Hash Password**: ‡πÉ‡∏ä‡πâ bcrypt ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
2. **Verify Password**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà hash ‡πÅ‡∏•‡πâ‡∏ß
3. **Create JWT Token**: ‡∏™‡∏£‡πâ‡∏≤‡∏á access token ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö authentication
4. **Decode JWT Token**: ‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™ token ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á user_id

**‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**
```python
hash_password(password: str) -> str           # ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
verify_password(plain, hashed) -> bool        # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
create_access_token(data: dict) -> str        # ‡∏™‡∏£‡πâ‡∏≤‡∏á JWT token
get_current_user(token: str) -> User          # ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user ‡∏à‡∏≤‡∏Å token
```

---

## üìÇ `/backend/db` - ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

### **session.py** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Database Session
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á database engine (‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö PostgreSQL)
- ‡∏™‡∏£‡πâ‡∏≤‡∏á session factory
- ‡∏™‡∏£‡πâ‡∏≤‡∏á Base class ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö models
- ‡∏°‡∏µ dependency `get_db()` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÉ‡∏ô routers

**‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
```python
def get_db():
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()
```

---

## üìÇ `/backend/models` - ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Tables)

### **user.py** - ‡∏ï‡∏≤‡∏£‡∏≤‡∏á users
**‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á:**
```python
id: UUID (Primary Key)
email: String (Unique)
full_name: String
hashed_password: String
avatar_url: String (path ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û)
created_at: DateTime
```

### **activity.py** - ‡∏ï‡∏≤‡∏£‡∏≤‡∏á activities
**‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á:**
```python
id: UUID (Primary Key)
user_id: UUID (Foreign Key ‚Üí users)
routine_id: UUID (Foreign Key ‚Üí routine_activities, nullable)
date: Date
title: String (‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°)
category: String (work, personal, health, social, etc.)
time: Time (nullable)
status: String (normal, urgent, done, cancelled)
all_day: Boolean
notes: String(2000) (‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)
subtasks: JSONB (‡∏á‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏¢ [{id, text, completed}])
created_at: DateTime
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á subtasks:**
```json
[
  {"id": "uuid1", "text": "‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£", "completed": false},
  {"id": "uuid2", "text": "‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•", "completed": true}
]
```

### **routine_activity.py** - ‡∏ï‡∏≤‡∏£‡∏≤‡∏á routine_activities (‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö)
**‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á:**
```python
id: UUID (Primary Key)
user_id: UUID (Foreign Key ‚Üí users)
day_of_week: String (mon, tue, wed, thu, fri, sat, sun)
title: String (‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö)
category: String
time: Time (nullable)
notes: String(2000) (‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö)
subtasks: JSONB (‡∏á‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏¢‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö)
```

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö Activity:**
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á activity ‡∏à‡∏≤‡∏Å‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö ‚Üí `activity.routine_id` ‡∏à‡∏∞‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `routine_activity.id`
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡∏ö‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö ‚Üí `activity.routine_id` ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô NULL

### **diary.py** - ‡∏ï‡∏≤‡∏£‡∏≤‡∏á diary_entries
**‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á:**
```python
id: UUID (Primary Key)
user_id: UUID (Foreign Key ‚Üí users)
date: Date (Unique per user)
mood_score: Integer (1-5)
mood_tags: JSONB (array ‡∏Ç‡∏≠‡∏á emoji tags)
summary: String(5000) (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô)
created_at: DateTime
updated_at: DateTime
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á mood_tags:**
```json
["üòä", "üí™", "üìö", "‚òï"]
```

---

## üìÇ `/backend/schemas` - Pydantic Schemas (Validation)

### **‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á Schemas:**
1. **Validate Request**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å frontend
2. **Validate Response**: ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö
3. **Type Hints**: ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ FastAPI ‡∏™‡∏£‡πâ‡∏≤‡∏á documentation ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

### **activities.py**
```python
ActivityCreate:  # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡∏°‡πà
  - title: str
  - category: str
  - date: date
  - time: Optional[time]
  - status: str
  - notes: Optional[str]
  - subtasks: Optional[List[Dict]]

ActivityUpdate:  # ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (‡∏ó‡∏∏‡∏Å field ‡πÄ‡∏õ‡πá‡∏ô Optional)
  - title: Optional[str]
  - status: Optional[str]
  - notes: Optional[str]
  - subtasks: Optional[List[Dict]]

ActivityOut:  # ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á frontend
  - id: UUID
  - title: str
  - date: date
  - status: str
  - routine_id: Optional[UUID]
  - subtasks: Optional[List[Dict]]
```

### **routine_activity.py**
```python
RoutineActivityCreate:
  - title: str
  - category: Optional[str]
  - time: Optional[time]
  - day_of_week: Optional[str]
  - notes: Optional[str]
  - subtasks: Optional[List[Dict]]

RoutineActivityResponse:
  - id: UUID
  - title: str
  - day_of_week: str
  - notes: Optional[str]
  - subtasks: Optional[List[Dict]]
```

---

## üìÇ `/backend/routers` - API Endpoints

### **login.py** - `/login/token`
**Endpoint:** `POST /login/token`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡∏£‡∏±‡∏ö email + password
2. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ user ‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (bcrypt verify)
4. ‡∏™‡∏£‡πâ‡∏≤‡∏á JWT token
5. ‡∏™‡πà‡∏á token ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ

**Request:**
```json
{
  "email": "user@example.com",
  "password": "mypassword"
}
```

**Response:**
```json
{
  "access_token": "eyJhbGciOiJIUzI1...",
  "token_type": "bearer"
}
```

### **register.py** - `/register`
**Endpoint:** `POST /register`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user (email, password, full_name)
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ email ‡∏ã‡πâ‡∏≥‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
3. Hash password
4. ‡∏™‡∏£‡πâ‡∏≤‡∏á user ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

### **activities.py** - `/activities`

#### `GET /activities?qdate=2025-11-23`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≤‡∏Å query parameter
2. ‡∏î‡∏∂‡∏á routine templates ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏±‡πâ‡∏ô (‡∏à‡∏≤‡∏Å day_of_week)
3. ‡∏î‡∏∂‡∏á activities ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
4. **‡∏™‡∏£‡πâ‡∏≤‡∏á activity ‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å routine templates** (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)
5. ‡∏™‡πà‡∏á activities ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ

**Logic ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**
```python
# 1. ‡∏î‡∏∂‡∏á routine templates ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏±‡πâ‡∏ô (‡πÄ‡∏ä‡πà‡∏ô mon, tue, wed)
routine_templates = db.query(RoutineActivity).filter(
    RoutineActivity.day_of_week == day_key,
    RoutineActivity.user_id == user.id
).all()

# 2. ‡∏î‡∏∂‡∏á activities ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
existing_activities = db.query(Activity).filter(
    Activity.date == target_date,
    Activity.user_id == user.id
).all()

# 3. ‡∏´‡∏≤‡∏ß‡πà‡∏≤‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á
existing_routine_ids = {act.routine_id for act in existing_activities}

# 4. ‡∏™‡∏£‡πâ‡∏≤‡∏á activities ‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö
for template in routine_templates:
    if template.id not in existing_routine_ids:
        # ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å notes ‡πÅ‡∏•‡∏∞ subtasks (‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï completed ‡πÄ‡∏õ‡πá‡∏ô false)
        new_activity = Activity(
            user_id=user.id,
            routine_id=template.id,
            title=template.title,
            category=template.category,
            time=template.time,
            notes=template.notes,
            subtasks=copy_subtasks(template.subtasks)  # ‡∏™‡∏£‡πâ‡∏≤‡∏á ID ‡πÉ‡∏´‡∏°‡πà
        )
        db.add(new_activity)
```

#### `GET /activities/{id}`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£

#### `POST /activities`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡∏°‡πà (manual)

#### `PUT /activities/{id}`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (title, status, notes, subtasks)

#### `DELETE /activities/{id}`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏•‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°

### **routine_activities.py** - `/routine-activities`

#### `GET /routine-activities`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏î‡∏∂‡∏á‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á user

#### `POST /routine-activities`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà

**Request:**
```json
{
  "title": "‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢",
  "category": "health",
  "time": "06:00:00",
  "day_of_week": "mon",
  "notes": "‡∏ß‡∏¥‡πà‡∏á 5 ‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£",
  "subtasks": [
    {"id": "uuid1", "text": "‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ä‡∏∏‡∏î‡∏ß‡∏¥‡πà‡∏á", "completed": false},
    {"id": "uuid2", "text": "‡∏ß‡∏≠‡∏£‡πå‡∏°‡∏≠‡∏±‡∏û", "completed": false}
  ]
}
```

#### `PUT /routine-activities/{id}`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö

#### `DELETE /routine-activities/{id}`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏•‡∏ö‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö
- ‡∏ï‡∏±‡πâ‡∏á `activity.routine_id = NULL` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö activities ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ
- ‡∏•‡∏ö‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö

### **diary.py** - `/diary`

#### `GET /diary?start_date=2025-11-01&end_date=2025-11-30`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏î‡∏∂‡∏á‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î

#### `GET /diary/{id}`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏î‡∏∂‡∏á‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£

#### `POST /diary`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà‡πÉ‡∏´‡∏°‡πà

**Request:**
```json
{
  "date": "2025-11-23",
  "mood_score": 4,
  "mood_tags": ["üòä", "üí™", "üìö"],
  "summary": "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô"
}
```

#### `PUT /diary/{id}`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà

#### `DELETE /diary/{id}`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏•‡∏ö‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà

### **trends.py** - `/trends` (Dashboard Analytics)

#### `GET /trends/mood?period=week&offset=0`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì mood score ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
- period: "week" ‡∏´‡∏£‡∏∑‡∏≠ "month"
- offset: 0=‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô, -1=‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á 1 period

**Response:**
```json
{
  "average_score": 3.8,
  "trend": "up",  // up, down, stable
  "change": 0.5
}
```

#### `GET /trends/mood-factors?period=week&offset=0`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏´‡∏≤ mood tags ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ö‡πà‡∏≠‡∏¢ (top 5 positive, top 5 negative)

**Response:**
```json
{
  "positive": [
    {"emoji": "üòä", "count": 10},
    {"emoji": "üí™", "count": 8}
  ],
  "negative": [
    {"emoji": "üòî", "count": 3},
    {"emoji": "üò∞", "count": 2}
  ]
}
```

#### `GET /trends/completion?period=week&offset=0`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°

**Response:**
```json
{
  "rate": 75.5,
  "total": 20,
  "completed": 15,
  "breakdown": {
    "‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß": 15,
    "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥": 3,
    "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°": 2
  }
}
```

#### `GET /trends/life-balance?period=week&offset=0`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°

**Response:**
```json
{
  "categories": [
    {"name": "work", "count": 10, "percentage": 50},
    {"name": "health", "count": 5, "percentage": 25},
    {"name": "personal", "count": 5, "percentage": 25}
  ],
  "warnings": ["‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà work ‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ"]
}
```

#### `GET /trends/summary?period=week&offset=0`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

### **profile.py** - `/profile`

#### `GET /profile/me`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user ‡∏ó‡∏µ‡πà login ‡∏≠‡∏¢‡∏π‡πà

#### `PUT /profile/me`
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user (full_name, avatar_url)

---

# üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á FRONTEND (React Native + Expo)

## üìÇ `/frontend` - ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å

### **App.js** - ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á Frontend
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á Navigation Stack
- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î screens ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö authentication (‡∏°‡∏µ token ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà)

**Navigation Structure:**
```
Stack Navigator
‚îú‚îÄ‚îÄ Login (‡∏´‡∏ô‡πâ‡∏≤ login)
‚îú‚îÄ‚îÄ Register (‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å)
‚îî‚îÄ‚îÄ Main (Tab Navigator)
    ‚îú‚îÄ‚îÄ Activities (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°)
    ‚îú‚îÄ‚îÄ Diary (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà)
    ‚îú‚îÄ‚îÄ Trends (‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°)
    ‚îî‚îÄ‚îÄ Profile (‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö)
```

---

## üìÇ `/frontend/src/api` - API Client

### **client.js** - Axios Configuration
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á axios instance
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ base URL (http://10.0.2.2:8000 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Android Emulator)
- ‡πÄ‡∏û‡∏¥‡πà‡∏° JWT token ‡πÉ‡∏ô Authorization header ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ response ‡πÅ‡∏•‡∏∞ error

**‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**
```javascript
const apiClient = axios.create({
  baseURL: 'http://10.0.2.2:8000'
});

// Interceptor: ‡πÄ‡∏û‡∏¥‡πà‡∏° token ‡∏ó‡∏∏‡∏Å request
apiClient.interceptors.request.use(async (config) => {
  const token = await AsyncStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// Interceptor: ‡∏î‡∏∂‡∏á data ‡∏à‡∏≤‡∏Å response.data
apiClient.interceptors.response.use(
  (response) => response.data,
  (error) => { throw error.response?.data || error.message; }
);
```

### **activities.js** - Activities API
```javascript
listActivities(qdate)                    // GET /activities?qdate=...
getActivity(id)                          // GET /activities/{id}
createActivity(data)                     // POST /activities
updateActivity(id, data)                 // PUT /activities/{id}
deleteActivity(id)                       // DELETE /activities/{id}
```

### **routines.js** - Routines API
```javascript
listRoutineActivities()                  // GET /routine-activities
createRoutineActivity(data)              // POST /routine-activities
updateRoutineActivity(id, data)          // PUT /routine-activities/{id}
deleteRoutineActivity(id)                // DELETE /routine-activities/{id}
```

**Normalization:**
- ‡πÅ‡∏õ‡∏•‡∏á subtasks ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö `[{id, text, completed}]`
- Filter subtasks ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏≠‡∏Å
- ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô "HH:MM:SS"

### **diary.js** - Diary API
```javascript
listDiaryEntries(start_date, end_date)   // GET /diary?start_date=...
getDiaryEntry(id)                        // GET /diary/{id}
createDiaryEntry(data)                   // POST /diary
updateDiaryEntry(id, data)               // PUT /diary/{id}
deleteDiaryEntry(id)                     // DELETE /diary/{id}
```

### **trends.js** - Trends API
```javascript
getDashboardSummary(period, offset)      // GET /trends/summary?period=...
getMoodTrend(period, offset)             // GET /trends/mood?period=...
getMoodFactors(period, offset)           // GET /trends/mood-factors?period=...
getCompletionRate(period, offset)        // GET /trends/completion?period=...
getLifeBalance(period, offset)           // GET /trends/life-balance?period=...
```

### **auth.js** - Authentication API
```javascript
loginApi({email, password})              // POST /login/token
registerApi({email, password, full_name}) // POST /register
meApi()                                  // GET /profile/me
updateProfileApi(data)                   // PUT /profile/me
```

---

## üìÇ `/frontend/src/screens` - ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ï‡πà‡∏≤‡∏á‡πÜ

### **Login.js** - ‡∏´‡∏ô‡πâ‡∏≤ Login
**Flow:**
1. ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≠‡∏Å email + password
2. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö"
3. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `loginApi({email, password})`
4. ‡πÑ‡∏î‡πâ token ‡∏°‡∏≤ ‚Üí ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô AsyncStorage
5. Navigate ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Main (Tab Navigator)

**‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Input:**
- Trim ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á
- ‡∏•‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà ASCII ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å email (‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ú‡∏¥‡∏î)

### **Register.js** - ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
**Flow:**
1. ‡∏Å‡∏£‡∏≠‡∏Å email, password, full_name
2. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `registerApi()`
3. ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚Üí Navigate ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Login

### **Activities.js** - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå (‡∏à-‡∏≠‡∏≤)
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏±‡πâ‡∏ô
3. ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏° routine_id)
4. ‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

**State Management:**
```javascript
const [selectedDate, setSelectedDate] = useState(toDateString(new Date()))
const [activities, setActivities] = useState([])

// ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
const loadActivities = async (date) => {
  const data = await listActivities(date);
  setActivities(data.items);
}

// ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
const handleStatusChange = async (activityId, newStatus) => {
  await updateActivity(activityId, { status: newStatus });
  loadActivities(selectedDate);
}
```

**‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°:**
- ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏à‡∏≤‡∏Å routine ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô group
- ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏õ‡∏Å‡∏ï‡∏¥ ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏¢‡∏Å

### **ActivityDetail.js** - ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (title, date, time, category)
2. ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç notes (inline editing)
3. ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡πä‡∏Å subtasks
4. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Notes:**
```javascript
const [editingNotes, setEditingNotes] = useState(false);
const [notesText, setNotesText] = useState("");

// ‡∏Å‡∏î‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏î‡∏¥‡∏ô‡∏™‡∏≠ ‚Üí ‡πÅ‡∏™‡∏î‡∏á TextInput
// ‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å updateActivity
const handleSaveNotes = async () => {
  await updateActivity(id, { notes: notesText });
  setActivity({ ...activity, notes: notesText });
  setEditingNotes(false);
}
```

**‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡πä‡∏Å Subtask:**
```javascript
const toggleSubtask = async (subtaskId) => {
  const updatedSubtasks = activity.subtasks.map(st =>
    st.id === subtaskId ? { ...st, completed: !st.completed } : st
  );
  await updateActivity(id, { subtasks: updatedSubtasks });
  setActivity({ ...activity, subtasks: updatedSubtasks });
}
```

### **EditActivity.js** - ‡∏™‡∏£‡πâ‡∏≤‡∏á/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (title, category, date, time, notes)
2. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏¢ (subtasks)
3. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°

**‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Subtasks:**
```javascript
const [subtasks, setSubtasks] = useState([]);

const addSubtask = () => {
  setSubtasks([...subtasks, { id: Date.now().toString(), text: '', completed: false }]);
}

const updateSubtask = (id, text) => {
  setSubtasks(subtasks.map(st => st.id === id ? { ...st, text } : st));
}

const removeSubtask = (id) => {
  setSubtasks(subtasks.filter(st => st.id !== id));
}
```

### **Diary.js** - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
2. ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô
3. ‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà

### **EditDiary.js** - ‡∏™‡∏£‡πâ‡∏≤‡∏á/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà (date, mood_score, mood_tags, summary)
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å mood tags ‡∏à‡∏≤‡∏Å emoji picker
3. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà

**Mood Tags:**
```javascript
const MOOD_TAGS = {
  positive: ["üòä", "üòÅ", "üí™", "üéâ", "‚ù§Ô∏è", "üìö", "‚òï"],
  negative: ["üòî", "üò∞", "üò°", "üò´", "üò∑", "üíî"]
}

const toggleTag = (emoji) => {
  if (selectedTags.includes(emoji)) {
    setSelectedTags(selectedTags.filter(t => t !== emoji));
  } else {
    setSelectedTags([...selectedTags, emoji]);
  }
}
```

### **Trends.js** - Dashboard ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡πÅ‡∏™‡∏î‡∏á mood trend (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ + ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°)
2. ‡πÅ‡∏™‡∏î‡∏á mood factors (top 5 positive/negative tags)
3. ‡πÅ‡∏™‡∏î‡∏á completion rate (‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à)
4. ‡πÅ‡∏™‡∏î‡∏á life balance (‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà)
5. ‡∏™‡∏•‡∏±‡∏ö‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á week/month
6. ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á (offset -1, -2, ...)

**State Management:**
```javascript
const [period, setPeriod] = useState('week');  // 'week' ‡∏´‡∏£‡∏∑‡∏≠ 'month'
const [offset, setOffset] = useState(0);       // 0=‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô, -1=‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á
const [data, setData] = useState(null);

const loadData = async () => {
  const result = await getDashboardSummary(period, offset);
  setData(result);
}

// ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô period
const handlePeriodChange = (newPeriod) => {
  setPeriod(newPeriod);
  setOffset(0);
}

// ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏î‡∏π‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á
const goToPrevious = () => setOffset(offset - 1);
const goToNext = () => setOffset(offset + 1);
```

### **Profile.js** - ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user (full_name, email, avatar)
2. ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô)
3. ‡∏™‡∏£‡πâ‡∏≤‡∏á/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö
4. Logout

**‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö:**
```javascript
const [allRoutines, setAllRoutines] = useState([]);

const loadRoutines = async () => {
  const data = await listRoutineActivities();
  setAllRoutines(data);
}

// ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô
const routinesByDay = {
  mon: allRoutines.filter(r => r.day_of_week === 'mon'),
  tue: allRoutines.filter(r => r.day_of_week === 'tue'),
  // ...
}
```

### **EditRoutine.js** - ‡∏™‡∏£‡πâ‡∏≤‡∏á/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö (title, category, time, notes, subtasks)
2. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö
3. ‡∏•‡∏ö‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö (‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç)

**‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Subtasks:**
```javascript
const [subtasks, setSubtasks] = useState(routine?.subtasks || []);

const addSubtask = () => {
  setSubtasks([...subtasks, { id: Date.now().toString(), text: '', completed: false }]);
}

const handleSave = async () => {
  const payload = {
    title: title.trim(),
    category,
    time: time ? `${time}:00` : null,
    notes: notes.trim() || null,
    subtasks: subtasks.length > 0 ? subtasks : null,
    day_of_week: currentDayKey
  };
  
  if (isEditMode) {
    await updateRoutineActivity(routine.id, payload);
  } else {
    await createRoutineActivity(payload);
  }
}
```

### **EditProfile.js** - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:**
1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç full_name
2. ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ avatar
3. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

---

## üìÇ `/frontend/src/components` - Components ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥

### **TextInputField.js**
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** Input field ‡∏û‡∏£‡πâ‡∏≠‡∏° label ‡πÅ‡∏•‡∏∞ styling

### **DateTimeInput.js**
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** Input ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤

### **StatusPill.js**
**‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà:** ‡πÅ‡∏™‡∏î‡∏á badge ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (normal, urgent, done, cancelled)

---

## üìÇ `/frontend/src/utils` - ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠

### **constants.js** - ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà
```javascript
STATUSES = {
  normal: { label: '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°', color: '#595959', backgroundColor: '#f5f5f5' },
  urgent: { label: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥', color: '#faad14', backgroundColor: '#fffbe6' },
  done: { label: '‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß', color: '#52c41a', backgroundColor: '#f6ffed' },
  cancelled: { label: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å', color: '#ff4d4f', backgroundColor: '#fff1f0' }
}

CATEGORIES = [
  { name: 'work', label: '‡∏á‡∏≤‡∏ô', emoji: 'üíº' },
  { name: 'personal', label: '‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß', emoji: 'üè†' },
  { name: 'health', label: '‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û', emoji: 'üí™' },
  { name: 'social', label: '‡∏™‡∏±‡∏á‡∏Ñ‡∏°', emoji: 'üë•' },
  { name: 'learning', label: '‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ', emoji: 'üìö' },
  { name: 'finance', label: '‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô', emoji: 'üí∞' }
]

TH_DAYS = ['‡∏≠‡∏≤', '‡∏à', '‡∏≠', '‡∏û', '‡∏û‡∏§', '‡∏®', '‡∏™']
TH_DAYS_FULL = {
  sun: '‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå', mon: '‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå', tue: '‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£', wed: '‡∏û‡∏∏‡∏ò',
  thu: '‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ', fri: '‡∏®‡∏∏‡∏Å‡∏£‡πå', sat: '‡πÄ‡∏™‡∏≤‡∏£‡πå'
}
```

### **dateUtils.js** - ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
```javascript
// ‡πÅ‡∏õ‡∏•‡∏á Date ‡πÄ‡∏õ‡πá‡∏ô "YYYY-MM-DD"
toDateString(date) {
  const y = date.getFullYear();
  const m = String(date.getMonth() + 1).padStart(2, '0');
  const d = String(date.getDate()).padStart(2, '0');
  return `${y}-${m}-${d}`;
}

// ‡πÅ‡∏õ‡∏•‡∏á Date ‡πÄ‡∏õ‡πá‡∏ô "HH:MM"
toTimeString(date) {
  const h = String(date.getHours()).padStart(2, '0');
  const m = String(date.getMinutes()).padStart(2, '0');
  return `${h}:${m}`;
}

// ‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
getStartOfWeek(date) {
  const day = date.getDay(); // 0=‡∏≠‡∏≤, 1=‡∏à, ..., 6=‡∏™
  const diff = day === 0 ? -6 : -(day - 1); // ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å
  const monday = new Date(date);
  monday.setDate(date.getDate() + diff);
  return monday;
}

// ‡πÅ‡∏õ‡∏•‡∏á day number ‡πÄ‡∏õ‡πá‡∏ô day key
getDayKey(date) {
  const days = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];
  return days[date.getDay()];
}
```

---

# üîÑ Data Flow - ‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

## 1Ô∏è‚É£ **Login Flow**
```
User ‡∏Å‡∏£‡∏≠‡∏Å email + password
  ‚Üì
Login.js ‚Üí loginApi({email, password})
  ‚Üì
POST /login/token (backend)
  ‚Üì
backend ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö user ‡πÅ‡∏•‡∏∞ password
  ‚Üì
backend ‡∏™‡∏£‡πâ‡∏≤‡∏á JWT token
  ‚Üì
frontend ‡πÄ‡∏Å‡πá‡∏ö token ‡πÉ‡∏ô AsyncStorage
  ‚Üì
Navigate ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Main
```

## 2Ô∏è‚É£ **Create Activity from Routine Flow**
```
User ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ Activities ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô 23 ‡∏û.‡∏¢.
  ‚Üì
Activities.js ‚Üí listActivities('2025-11-23')
  ‚Üì
GET /activities?qdate=2025-11-23 (backend)
  ‚Üì
backend logic:
  1. ‡∏î‡∏∂‡∏á routines ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏û‡∏∏‡∏ò (wed)
  2. ‡∏î‡∏∂‡∏á activities ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 23 ‡∏û.‡∏¢.
  3. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ routine ‡πÑ‡∏´‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô activity
  4. ‡∏™‡∏£‡πâ‡∏≤‡∏á activities ‡πÉ‡∏´‡∏°‡πà ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å notes + subtasks
  5. ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ activities ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ
  ‚Üì
frontend ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
```

## 3Ô∏è‚É£ **Edit Notes Flow**
```
User ‡∏Å‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡∏π‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
  ‚Üì
ActivityDetail.js ‚Üí getActivity(id)
  ‚Üì
GET /activities/{id} (backend)
  ‚Üì
‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î + notes
  ‚Üì
User ‡∏Å‡∏î‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏î‡∏¥‡∏ô‡∏™‡∏≠ ‚Üí ‡πÅ‡∏™‡∏î‡∏á TextInput
  ‚Üì
User ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç notes ‚Üí ‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
  ‚Üì
ActivityDetail.js ‚Üí updateActivity(id, {notes: newNotes})
  ‚Üì
PUT /activities/{id} (backend)
  ‚Üì
backend ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  ‚Üì
frontend ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï state
```

## 4Ô∏è‚É£ **Toggle Subtask Flow**
```
User ‡∏Å‡∏î‡∏ï‡∏¥‡πä‡∏Å‡∏ñ‡∏π‡∏Å‡∏ó‡∏µ‡πà subtask
  ‚Üì
ActivityDetail.js ‚Üí toggleSubtask(subtaskId)
  ‚Üì
‡∏™‡∏£‡πâ‡∏≤‡∏á updatedSubtasks (toggle completed)
  ‚Üì
ActivityDetail.js ‚Üí updateActivity(id, {subtasks: updatedSubtasks})
  ‚Üì
PUT /activities/{id} (backend)
  ‚Üì
backend ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (JSONB field)
  ‚Üì
frontend ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï state
```

## 5Ô∏è‚É£ **Create Routine Template Flow**
```
User ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Profile ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå ‚Üí ‡∏Å‡∏î +
  ‚Üì
Navigate ‡πÑ‡∏õ EditRoutine.js (create mode)
  ‚Üì
User ‡∏Å‡∏£‡∏≠‡∏Å title, category, time, notes, subtasks
  ‚Üì
‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‚Üí createRoutineActivity(data)
  ‚Üì
POST /routine-activities (backend)
  ‚Üì
backend ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏•‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  ‚Üì
frontend ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Profile
  ‚Üì
Profile.js ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
```

## 6Ô∏è‚É£ **Delete Routine Flow**
```
User ‡∏Å‡∏î‡∏•‡∏ö‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö
  ‚Üì
EditRoutine.js ‚Üí deleteRoutineActivity(id)
  ‚Üì
DELETE /routine-activities/{id} (backend)
  ‚Üì
backend logic:
  1. ‡∏´‡∏≤ activities ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ
  2. ‡∏ï‡∏±‡πâ‡∏á routine_id = NULL (‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏õ‡∏Å‡∏ï‡∏¥)
  3. ‡∏•‡∏ö‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö
  ‚Üì
frontend ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Profile
```

## 7Ô∏è‚É£ **View Trends Flow**
```
User ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ Trends
  ‚Üì
Trends.js ‚Üí getDashboardSummary('week', 0)
  ‚Üì
GET /trends/summary?period=week&offset=0 (backend)
  ‚Üì
backend ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì:
  - mood average (‡∏à‡∏≤‡∏Å diary_entries)
  - mood factors (top tags)
  - completion rate (‡∏à‡∏≤‡∏Å activities)
  - life balance (‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô categories)
  ‚Üì
‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ
  ‚Üì
frontend ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
```

---

# üîê Security & Authentication

## JWT Token Flow
```
1. User login ‚Üí backend ‡∏™‡∏£‡πâ‡∏≤‡∏á JWT token
   Token = { sub: user_id, exp: expiration_time }
   
2. Frontend ‡πÄ‡∏Å‡πá‡∏ö token ‡πÉ‡∏ô AsyncStorage

3. ‡∏ó‡∏∏‡∏Å API request ‚Üí client.js ‡πÄ‡∏û‡∏¥‡πà‡∏° header:
   Authorization: Bearer <token>

4. Backend middleware (get_current_user):
   - ‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™ token
   - ‡∏î‡∏∂‡∏á user_id
   - ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ user ‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
   - ‡∏™‡πà‡∏á user object ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö router function

5. ‡∏ñ‡πâ‡∏≤ token ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‚Üí 403 Forbidden
   ‚Üí Frontend redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Login
```

## Password Hashing
```
Register: password ‚Üí bcrypt.hash() ‚Üí hashed_password (‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô DB)
Login: password + hashed_password ‚Üí bcrypt.verify() ‚Üí True/False
```

---

# üìä Database Schema Summary

```sql
-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á users
users (
  id UUID PRIMARY KEY,
  email VARCHAR UNIQUE,
  full_name VARCHAR,
  hashed_password VARCHAR,
  avatar_url VARCHAR,
  created_at TIMESTAMP
)

-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á routine_activities (‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö)
routine_activities (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  day_of_week VARCHAR(10),  -- mon, tue, wed, thu, fri, sat, sun
  title VARCHAR(255),
  category VARCHAR(100),
  time TIME,
  notes VARCHAR(2000),      -- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
  subtasks JSONB            -- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà: [{id, text, completed}]
)

-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á activities (‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏£‡∏¥‡∏á)
activities (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  routine_id UUID REFERENCES routine_activities(id) ON DELETE SET NULL,
  date DATE,
  title VARCHAR(255),
  category VARCHAR(100),
  time TIME,
  status VARCHAR(50),       -- normal, urgent, done, cancelled
  all_day BOOLEAN,
  notes VARCHAR(2000),
  subtasks JSONB,           -- [{id, text, completed}]
  created_at TIMESTAMP,
  updated_at TIMESTAMP
)

-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á diary_entries
diary_entries (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id) ON DELETE CASCADE,
  date DATE,
  mood_score INTEGER,       -- 1-5
  mood_tags JSONB,          -- ["üòä", "üí™", "üìö"]
  summary VARCHAR(5000),
  created_at TIMESTAMP,
  updated_at TIMESTAMP,
  UNIQUE(user_id, date)     -- 1 user = 1 diary ‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô
)
```

---

# üöÄ ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ö‡∏ö End-to-End

## ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå: User ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö
```
1. User ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ ‚Üí Login
   - Frontend: Login.js ‚Üí loginApi()
   - Backend: POST /login/token ‚Üí ‡∏™‡πà‡∏á JWT token ‡∏Å‡∏•‡∏±‡∏ö
   - Frontend: ‡πÄ‡∏Å‡πá‡∏ö token ‚Üí Navigate ‡πÑ‡∏õ Main

2. User ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Profile ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå" ‚Üí ‡∏Å‡∏î +
   - Navigate ‡πÑ‡∏õ EditRoutine.js (day_of_week = 'mon')

3. User ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
   - title: "‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢"
   - category: "health"
   - time: "06:00"
   - notes: "‡∏ß‡∏¥‡πà‡∏á 5 ‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞"
   - subtasks:
     ‚Ä¢ "‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ä‡∏∏‡∏î‡∏ß‡∏¥‡πà‡∏á"
     ‚Ä¢ "‡∏ß‡∏≠‡∏£‡πå‡∏°‡∏≠‡∏±‡∏û‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢"
     ‚Ä¢ "‡∏¢‡∏∑‡∏î‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πà‡∏á"

4. ‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
   - Frontend: EditRoutine.js ‚Üí createRoutineActivity(data)
   - Backend: POST /routine-activities
   - DB: INSERT INTO routine_activities (...)
   - Frontend: ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Profile ‚Üí ‡πÇ‡∏ä‡∏ß‡πå‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà
```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
```
5. ‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏ñ‡∏∂‡∏á ‚Üí User ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ Activities
   - Frontend: Activities.js ‚Üí listActivities('2025-11-25')
   - Backend: GET /activities?qdate=2025-11-25

6. Backend logic:
   - ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25 ‡∏û.‡∏¢. = ‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå
   - query routine_activities WHERE day_of_week = 'mon'
   - ‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö "‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢"
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ activity ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á activity ‡πÉ‡∏´‡∏°‡πà:
     * ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å title, category, time, notes
     * ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å subtasks (‡∏™‡∏£‡πâ‡∏≤‡∏á ID ‡πÉ‡∏´‡∏°‡πà, ‡∏ï‡∏±‡πâ‡∏á completed = false)
   - INSERT INTO activities (...)
   - ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ activities ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ

7. Frontend ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° "‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢"
   - ‡∏°‡∏µ 3 subtasks (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡πä‡∏Å)
   - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°" (normal)
```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 3: User ‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
```
8. User ‡∏Å‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
   - Navigate ‡πÑ‡∏õ ActivityDetail.js
   - ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: getActivity(id)
   - ‡πÅ‡∏™‡∏î‡∏á notes: "‡∏ß‡∏¥‡πà‡∏á 5 ‡∏Å‡∏¥‡πÇ‡∏•‡πÄ‡∏°‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞"
   - ‡πÅ‡∏™‡∏î‡∏á subtasks: 3 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£

9. User ‡∏ï‡∏¥‡πä‡∏Å‡∏ñ‡∏π‡∏Å "‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ä‡∏∏‡∏î‡∏ß‡∏¥‡πà‡∏á"
   - Frontend: toggleSubtask(subtask_id)
   - ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï subtasks array (completed = true)
   - Backend: PUT /activities/{id} {subtasks: [...]}
   - DB: UPDATE activities SET subtasks = '[...]'

10. User ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥"
    - Frontend: handleStatusChange(id, 'urgent')
    - Backend: PUT /activities/{id} {status: 'urgent'}
    - UI: badge ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ

11. User ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô "‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß"
    - Frontend: handleStatusChange(id, 'done')
    - UI: badge ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà
```
12. User ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Diary ‚Üí ‡∏Å‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡∏≠‡∏≤‡∏£‡∏µ‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
    - Navigate ‡πÑ‡∏õ EditDiary.js
    - ‡∏Å‡∏£‡∏≠‡∏Å:
      * mood_score: 4
      * mood_tags: ["üòä", "üí™", "üèÉ"]
      * summary: "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ß‡∏¥‡πà‡∏á‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö 5 ‡∏Å‡∏°. ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô"
    - ‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
    - Backend: POST /diary
    - DB: INSERT INTO diary_entries (...)
```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 5: ‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
```
13. User ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Trends
    - Frontend: getDashboardSummary('week', 0)
    - Backend: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì:
      * Mood average: (4+3+5+4+3+4+4) / 7 = 3.86
      * Top mood tags: üí™ (5 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á), üòä (4 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)
      * Completion rate: 15/20 = 75%
      * Life balance: health (30%), work (50%), personal (20%)
    - Frontend: ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
```

---

# üîß ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà 1: Status Labels ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô
**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:** Trends dashboard ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏¥‡∏î  
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** Frontend ‡πÉ‡∏ä‡πâ key "success", Backend ‡πÉ‡∏ä‡πâ "done"  
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï constants.js ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô (normal, urgent, done, cancelled)

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà 2: Week Calculation ‡∏ú‡∏¥‡∏î
**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:** ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡πÅ‡∏ó‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå  
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** getStartOfWeek() ‡πÉ‡∏ä‡πâ Sunday as day 0  
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** ‡πÅ‡∏Å‡πâ logic ‡πÉ‡∏´‡πâ Monday ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà 3: Foreign Key Error ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡∏ö Routine
**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:** ‡∏•‡∏ö‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏µ activities ‡∏ó‡∏µ‡πà‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á  
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** ‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö ‡πÉ‡∏´‡πâ SET routine_id = NULL ‡∏Å‡πà‡∏≠‡∏ô

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà 4: Login ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÑ‡∏ó‡∏¢
**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:** Email validation error (THAI CHARACTER PHINTHU)  
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** Trim ‡πÅ‡∏•‡∏∞‡∏•‡∏ö non-ASCII characters ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å email

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà 5: Notes ‡πÅ‡∏•‡∏∞ Subtasks ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ Backend
**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:** ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß notes/subtasks ‡πÄ‡∏õ‡πá‡∏ô NULL  
**‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:** ‡πÄ‡∏û‡∏¥‡πà‡∏° notes ‡πÅ‡∏•‡∏∞ subtasks ‡πÉ‡∏ô normalizeRoutinePayload()

---

# üìù ‡∏™‡∏£‡∏∏‡∏õ Key Concepts

## 1. **Routine Templates vs Activities**
- **Routine Template** = ‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ã‡πâ‡∏≥‡∏ó‡∏∏‡∏Å‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå (‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô routine_activities)
- **Activity** = ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô (‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô activities)
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ Activities ‚Üí Backend ‡∏à‡∏∞ instantiate templates ‡πÄ‡∏õ‡πá‡∏ô activities ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

## 2. **Subtasks Structure**
```json
[
  {
    "id": "uuid-string",
    "text": "‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏¢",
    "completed": false
  }
]
```
- ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô JSONB ‡πÉ‡∏ô PostgreSQL
- Frontend update ‡∏ó‡∏±‡πâ‡∏á array ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á

## 3. **JWT Authentication**
- Token ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô AsyncStorage (persistent)
- Interceptor ‡πÄ‡∏û‡∏¥‡πà‡∏° header ‡∏ó‡∏∏‡∏Å request ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- Backend verify token ‚Üí get user ‚Üí ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ router function

## 4. **Data Normalization**
- Frontend normalize payload ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô HH:MM ‚Üí HH:MM:SS)
- Backend validate ‡∏î‡πâ‡∏ß‡∏¢ Pydantic schemas
- Response ‡∏ú‡πà‡∏≤‡∏ô interceptor ‚Üí ‡∏î‡∏∂‡∏á response.data ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

## 5. **State Management**
- ‡πÉ‡∏ä‡πâ React useState ‡πÅ‡∏•‡∏∞ useEffect
- ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ focus (navigation.addListener)
- Local state update ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å API call ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à

---

# üéì ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡πà‡∏≠

## 1. ‡πÄ‡∏û‡∏¥‡πà‡∏° Chart Visualization
- ‡πÉ‡∏ä‡πâ react-native-chart-kit
- ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà placeholders ‡πÉ‡∏ô Trends.js ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏£‡∏≤‡∏ü‡∏à‡∏£‡∏¥‡∏á

## 2. Notification System
- ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
- ‡πÉ‡∏ä‡πâ expo-notifications

## 3. Data Sync
- ‡πÄ‡∏û‡∏¥‡πà‡∏° loading states
- Optimistic updates
- Error handling ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô

## 4. Performance Optimization
- Pagination ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏ß‡πÜ
- Memoization (React.memo, useMemo)
- Lazy loading

---

**‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö Planary ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà Backend API, Database, Frontend Screens, ‡πÅ‡∏•‡∏∞ Data Flow ‡∏Ñ‡∏£‡∏±‡∏ö** üöÄ
